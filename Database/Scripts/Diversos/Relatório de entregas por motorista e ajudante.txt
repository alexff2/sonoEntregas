declare @iniEmiss datetime, @fimEmiss datetime
set @iniEmiss = '2024-08-01'
set @fimEmiss = '2024-08-31'
--Total
/*SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA, A.DELIVERED) B ON A.ID = B.ID_DRIVER
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC
-- Retornos
SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 1
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA) B ON A.ID = B.ID_DRIVER
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC
--Entregas
SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 0
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_DRIVER, A.CODLOJA) B ON A.ID = B.ID_DRIVER
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC*/

------------------------------------ AJUDANTES-----------------------------------------
--Total
/*SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA, A.DELIVERED) B ON A.ID = B.ID_ASSISTANT
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC
--Entregas
SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 0
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA) B ON A.ID = B.ID_ASSISTANT
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC
--Retornos
SELECT A.DESCRIPTION, COUNT(B.ID_SALE) QTD_VENDA FROM USERS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 1
	GROUP BY A.ID_DELIVERY, A.ID_SALE, B.ID_ASSISTANT, A.CODLOJA) B ON A.ID = B.ID_ASSISTANT
GROUP BY A.DESCRIPTION
ORDER BY QTD_VENDA DESC*/
------------------------------------ LOJAS -----------------------------------------
--Total
/*SELECT A.DESCRICAO, COUNT(B.ID_SALE) QTD_VENDA FROM LOJAS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss
	GROUP BY A.ID_DELIVERY, A.ID_SALE, A.CODLOJA, A.DELIVERED) B ON A.CODLOJA = B.CODLOJA
GROUP BY A.DESCRICAO
ORDER BY QTD_VENDA DESC
--Entregas
SELECT A.DESCRICAO, COUNT(B.ID_SALE) QTD_VENDA FROM LOJAS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 0
	GROUP BY A.ID_DELIVERY, A.ID_SALE, A.CODLOJA) B ON A.CODLOJA = B.CODLOJA
GROUP BY A.DESCRICAO
ORDER BY QTD_VENDA DESC
--Retornos
SELECT A.DESCRICAO, COUNT(B.ID_SALE) QTD_VENDA FROM LOJAS A
RIGHT JOIN 
	(SELECT A.ID_DELIVERY, A.ID_SALE, A.CODLOJA
	FROM DELIVERYS_PROD A
	INNER JOIN DELIVERYS B ON A.ID_DELIVERY = B.ID
	LEFT JOIN SALES C ON A.ID_SALE = C.ID_SALES
	WHERE B.D_DELIVERED BETWEEN @iniEmiss AND @fimEmiss AND A.DELIVERED = 1
	GROUP BY A.ID_DELIVERY, A.ID_SALE, A.CODLOJA) B ON A.CODLOJA = B.CODLOJA
GROUP BY A.DESCRICAO
ORDER BY QTD_VENDA DESC*/
