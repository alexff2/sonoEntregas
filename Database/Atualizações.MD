# Pendências Lojas
- CD
  * Criar usuários CD (ok, validar e colocar em produção!)
  * Arrumar DAV com mesma numeração
  * Criar modulo de previsão
  * Padronizar rotas
  * Testar alerta de erro

- Lojas
  * Verificar codigos e descrição nas lojas de acordo com base de dados do CD;
  * Separar vendas iniciadas e colocar o nome ENTREGAS - Melhorar visualização
  * Colocar horario de entregas
  * Colocar loading (ok, validar e colocar em produção!)
  * Criar modulo de relatórios

# Atualização de banco
ALTER TABLE USERS ADD PRE_REG BIT NOT NULL DEFAULT 0
UPDATE USERS SET PRE_REG = 1
UPDATE USERS SET PASSWORD = 0 WHERE OFFICE IN ('Driver', 'Assistant')
ALTER TABLE DELIVERYS ADD ID_USER_MOUNT FLOAT NOT NULL DEFAULT 0
ALTER TABLE DELIVERYS ADD ID_USER_DELIVERING FLOAT
ALTER TABLE DELIVERYS ADD ID_USER_DELIVERED FLOAT
ATUALIZAR VIEW_DELIVERY, VIEW_SALES_PROD (novas variáveis)
ATUALIZAR VIEW_DELIV_SALES, VIEW_DELIVERY_PROD2 (novas variáveis)
ALTER VIEW [dbo].[VIEW_SALES_PROD] AS
SELECT A.ID_SALE_ID, A.ID_SALES, A.CODPRODUTO, A.COD_ORIGINAL, A.CODLOJA, A.DESCONTO, C.NOME, A.DOWN_EST, A.NVTOTAL, A.[STATUS], 
A.UNITARIO1, A.QUANTIDADE,
CASE WHEN B.QTD_MOUNTING IS NULL THEN 0 ELSE B.QTD_MOUNTING END QTD_MOUNTING,
CASE WHEN B.QTD_DELIVERING IS NULL THEN 0 ELSE B.QTD_DELIVERING END QTD_DELIVERING,
CASE WHEN B.QTD_DELIVERED IS NULL THEN 0 ELSE B.QTD_DELIVERED END QTD_DELIVERED,
A.QUANTIDADE - (CASE WHEN B.QTD_MOUNTING IS NULL THEN 0 ELSE B.QTD_MOUNTING END) openQuantity
FROM SALES_PROD A 
INNER JOIN SONO..PRODUTOS C ON A.COD_ORIGINAL = C.ALTERNATI
LEFT JOIN VIEW_DELIV_PROD_QTD_DELIVERING B ON A.CODLOJA = B.CODLOJA AND A.ID_SALES = B.ID_SALE AND A.COD_ORIGINAL = B.COD_ORIGINAL
ALTER VIEW [dbo].[VIEW_DELIVERY_PROD2] AS
SELECT A.ID_DELIVERY, B.*, A.QTD_DELIV,A.D_MOUNTING, A.D_DELIVERING, A.D_DELIVERED, A.DELIVERED, A.REASON_RETURN,
C.QTD_MOUNTING, C.QTD_DELIVERING, C.QTD_DELIVERED, D.NOME
FROM DELIVERYS_PROD A
INNER JOIN SONO..PRODUTOS D ON A.COD_ORIGINAL = D.ALTERNATI
INNER JOIN SALES_PROD B 
	ON A.ID_SALE = B.ID_SALES AND A.COD_ORIGINAL = B.COD_ORIGINAL AND A.CODLOJA = B.CODLOJA
LEFT JOIN VIEW_DELIV_PROD_QTD_DELIVERING C 
	ON A.CODLOJA = C.CODLOJA AND A.COD_ORIGINAL = C.COD_ORIGINAL AND A.ID_SALE = C.ID_SALE
GO

Ajustar conexão mssql de data


## Pendências Futuras
* Imprimir dav pelo sistema;
* Analizar view_sales_prod coluna qtd zerada
## Etapas:
================================================================================

- Melhorar infra de consulta de entregas (contextDelivery para deixar sistema mais leve)
