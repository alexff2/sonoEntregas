CREATE VIEW VDRE 
AS
SELECT A.DESCRICAO, A.VALOR,
CASE WHEN A.VALOR is null THEN null ELSE ROUND(100 * A.VALOR / (
    SELECT SUM(RECEITA.VALOR) VALOR FROM (
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE E.RECEITA = 1 AND A.DT_CANC IS NULL
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TIT)*-1 AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') ANO_MES 
        FROM TTIT_CR A
        INNER JOIN TTP_DOC B ON A.TP_DOC_ID = B.ID
        WHERE B.COD_TP_DOC IN ('DEV')
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(VLR_TIT) VALOR, TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
        FROM TTIT_CR
        WHERE REP_ID = 1361
        AND TP_DOC_ID IN (144)
        GROUP BY TO_CHAR(DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(CREDITO) - SUM(DEBITO))*-1 VALOR, ANO_MES FROM (
            SELECT 
            CASE WHEN TP_DOC_ID = 100 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END CREDITO,
            CASE WHEN TP_DOC_ID = 266 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END DEBITO,
            TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
            FROM TTIT_CR
            WHERE REP_ID = 1361
            AND TP_DOC_ID IN (100, 266) AND PERC_COMIS > 0) A
        GROUP BY ANO_MES) RECEITA
    WHERE RECEITA.ANO_MES = A.ANO_MES
), 2)|| '%' END PERC, A.SEQ, A.ANO_MES FROM (
    SELECT 1 SEQ, 'RECEITA LIQUIDA' DESCRICAO, SUM(VALOR) VALOR, ANO_MES FROM (
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE E.RECEITA = 1 AND A.DT_CANC IS NULL
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TIT)*-1 AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') ANO_MES 
        FROM TTIT_CR A
        INNER JOIN TTP_DOC B ON A.TP_DOC_ID = B.ID
        WHERE B.COD_TP_DOC IN ('DEV')
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION 
        SELECT SUM(VLR_TIT) VALOR, TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
        FROM TTIT_CR
        WHERE REP_ID = 1361
        AND TP_DOC_ID IN (144)
        GROUP BY TO_CHAR(DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(CREDITO) - SUM(DEBITO))*-1 VALOR, ANO_MES FROM (
            SELECT 
            CASE WHEN TP_DOC_ID = 100 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END CREDITO,
            CASE WHEN TP_DOC_ID = 266 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END DEBITO,
            TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
            FROM TTIT_CR
            WHERE REP_ID = 1361
            AND TP_DOC_ID IN (100, 266) AND PERC_COMIS > 0) A
        GROUP BY ANO_MES)
    GROUP BY ANO_MES

    UNION
    SELECT 2 SEQ, ' - VENDAS' AS DESCRICAO, SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
    FROM TNFS_SAIDA A
    INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
    INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
    WHERE E.RECEITA = 1 AND A.DT_CANC IS NULL
    GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
    
    UNION
    SELECT 3 SEQ, ' - NDB' DESCRICAO, SUM(VLR_TIT) VALOR, TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
    FROM TTIT_CR
    WHERE REP_ID = 1361
    AND TP_DOC_ID IN (144)
    GROUP BY TO_CHAR(DT_EMIS, 'MM-YYYY')
    
    UNION
    SELECT 4 SEQ, ' - DEVOLUCOES' AS DESCRICAO, SUM(A.VLR_TIT)*-1 AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') ANO_MES 
    FROM TTIT_CR A
    INNER JOIN TTP_DOC B ON A.TP_DOC_ID = B.ID
    WHERE B.COD_TP_DOC IN ('DEV')
    GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
    
    UNION
    SELECT 5 SEQ, ' - VPC' AS DESCRICAO, (SUM(CREDITO) - SUM(DEBITO))*-1 VALOR, ANO_MES FROM (
        SELECT 
        CASE WHEN TP_DOC_ID = 100 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END CREDITO,
        CASE WHEN TP_DOC_ID = 266 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END DEBITO,
        TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
        FROM TTIT_CR
        WHERE REP_ID = 1361
        AND TP_DOC_ID IN (100, 266) AND PERC_COMIS > 0) A
    GROUP BY ANO_MES
    
    UNION
    SELECT 6 SEQ, '' DESCRICAO, null VALOR, TO_CHAR(A.DATA, 'MM-YYYY') ANO_MES 
    FROM TCALENDARIOS A
    GROUP BY TO_CHAR(A.DATA, 'MM-YYYY')

    UNION
    SELECT 7 SEQ, 'CUSTO MERCADORIA PRODUZIDA' DESCRICAO, SUM(VALOR)*-1 VALOR, ANO_MES 
    FROM (
        SELECT SUM(A.VLR_TIT) VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
        FROM TTIT_CP A
        INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
        INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
        INNER JOIN TTP_DOC D ON A.TP_DOC_ID = D.ID
        WHERE C.CTAPLFIN_ID = 175 AND D.COD_TP_DOC NOT IN ('ADT')
        GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TOTAL) VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ABI_MES
        FROM TNFS_ENTRADA A
        WHERE A.TFOR_ID = 8689
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TIT) VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
        FROM TTIT_CP A
        INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
        INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
        WHERE C.CTAPLFIN_ID = 183  AND A.TP_DOC_ID NOT in (226)
        GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
        UNION
        SELECT SUM(B.VLR_TOTAL)*-1 AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TCLIENTES C ON A.CLI_ID = C.ID
        INNER JOIN TDIVISOES_VENDAS D ON A.DIVD_ID = D.ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE A.DT_CANC IS NULL
        AND A.CLI_ID = 5308
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY'))
    GROUP BY ANO_MES

    UNION
    SELECT 8 SEQ, ' - TRANSF MP ENVIADAS' DESCRICAO, SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
    FROM TNFS_SAIDA A
    INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
    INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
    WHERE A.DT_CANC IS NULL
    AND A.CLI_ID = 5308
    GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
    
    UNION
    SELECT 8 SEQ, ' - TRANSF MP RECEBIDAS' DESCRICAO, SUM(A.VLR_TOTAL)*-1 VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ABI_MES
    FROM TNFS_ENTRADA A
    WHERE A.TFOR_ID = 8689
    GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
    
    UNION
    SELECT 8 SEQ, ' - MATERIAS PRIMAS' DESCRICAO,  SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID = 175 AND A.TP_DOC_ID NOT in (226)
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')

    UNION
    SELECT 9 SEQ, ' - FRETE FORNECEDORES' DESCRICAO,  SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID = 183
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    
    UNION
    SELECT 10 SEQ, '' DESCRICAO, null VALOR, TO_CHAR(A.DATA, 'MM-YYYY') ANO_MES 
    FROM TCALENDARIOS A
    GROUP BY TO_CHAR(A.DATA, 'MM-YYYY')
    
    UNION
    SELECT 11 SEQ, 'DESPESAS VARIÁVEIS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID = 106
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    
    UNION
    SELECT 12 SEQ, ' - '||C.DESCRICAO DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID = 106
    GROUP BY  C.DESCRICAO, TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    
    UNION
    SELECT 13 SEQ, '' DESCRICAO, null VALOR, TO_CHAR(A.DATA, 'MM-YYYY') ANO_MES 
    FROM TCALENDARIOS A
    GROUP BY TO_CHAR(A.DATA, 'MM-YYYY')
    
    UNION
    SELECT 14 SEQ, 'MARGEM DE CONTRIBUIÇÃO' DESCRICAO, SUM(VALOR) VALOR, ANO_MES 
    FROM (
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE E.RECEITA = 1 AND A.DT_CANC IS NULL
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION 
        SELECT SUM(VLR_TIT) VALOR, TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
        FROM TTIT_CR
        WHERE REP_ID = 1361
        AND TP_DOC_ID IN (144)
        GROUP BY TO_CHAR(DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TOTAL)*-1 VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ABI_MES
        FROM TNFS_ENTRADA A
        WHERE A.TFOR_ID = 8689
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(A.VLR_TIT)*-1) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') ANO_MES 
        FROM TTIT_CR A
        INNER JOIN TTP_DOC B ON A.TP_DOC_ID = B.ID
        WHERE B.COD_TP_DOC IN ('DEV')
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(CREDITO) - SUM(DEBITO))*-1 VALOR, ANO_MES FROM (
            SELECT 
            CASE WHEN TP_DOC_ID = 100 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END CREDITO,
            CASE WHEN TP_DOC_ID = 266 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END DEBITO,
            TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
            FROM TTIT_CR
            WHERE REP_ID = 1361
            AND TP_DOC_ID IN (100, 266) AND PERC_COMIS > 0) A
        GROUP BY ANO_MES
        UNION
        SELECT SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
        FROM TTIT_CP A
        INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
        INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
        WHERE C.CTAPLFIN_ID NOT IN (95,102,216,124) AND A.TP_DOC_ID NOT in (226)
        GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
        UNION
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE A.DT_CANC IS NULL
        AND A.CLI_ID = 5308
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY'))
    GROUP BY ANO_MES
    
    UNION
    SELECT 15 SEQ, '' DESCRICAO, null VALOR, TO_CHAR(A.DATA, 'MM-YYYY') ANO_MES 
    FROM TCALENDARIOS A
    GROUP BY TO_CHAR(A.DATA, 'MM-YYYY')
    
    UNION
    SELECT 16 SEQ, 'DESPESAS FIXAS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID = 124
    GROUP BY  TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    
    UNION
    SELECT A.SEQ, A.DESCRICAO, SUM(A.VALOR) VALOR, ANO_MES FROM
        (SELECT 17 SEQ, '* DESPESAS GERAIS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
        FROM TTIT_CP A
        INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
        WHERE B.CTAPLFIN_ID IN (125,127,129,133,137,138,145,148,151,153,157)
        GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
        UNION
        SELECT  17 SEQ, '* DESPESAS GERAIS' DESCRICAO, SUM(TIT.VlR_TIT)*-1, TO_CHAR(TIT.DT_VCTO, 'MM-YYYY') ANO_MES
        FROM TTIT_CP TIT
        WHERE TIT.CTAPLFIN_ID = 222 
        GROUP BY TO_CHAR(TIT.DT_VCTO, 'MM-YYYY')) A
    GROUP BY A.SEQ, A.DESCRICAO, ANO_MES
    UNION
    SELECT 18 SEQ, ' - ' || B.DESCRICAO DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID IN (125,127,129,137,138,145,148,151,153,157)
    GROUP BY B.CTA, B.DESCRICAO, TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 18 SEQ, ' - MANUTENÇÃO PREDIAL' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    WHERE A.CTAPLFIN_ID IN (134, 222)
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 18 SEQ, ' - MANUTENÇÃO EQUIPAMENTOS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 133 AND B.CTA <> '220401'
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 18 SEQ, ' - ' || B.DESCRICAO DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID IN (125,127,129,137,138,145,148,151,153,157)
    GROUP BY B.CTA, B.DESCRICAO, TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 19 SEQ, '* DESPESAS PESSOAIS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 161
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 20 SEQ, ' - ' || B.DESCRICAO DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 161
    GROUP BY B.CTA, B.DESCRICAO, TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 21 SEQ, '* DESPESAS FINANCEIRAS/BANCARIAS' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 169
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 22 SEQ, ' - ' || B.DESCRICAO DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 169
    GROUP BY B.CTA, B.DESCRICAO, TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 23 SEQ, '* IMOBILIZADO' DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 189 AND A.CTAPLFIN_ID <> 222
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    UNION
    SELECT 24SEQ, ' - ' || B.DESCRICAO, SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    WHERE B.CTAPLFIN_ID = 189 AND A.CTAPLFIN_ID <> 222
    GROUP BY B.DESCRICAO,  TO_CHAR(A.DT_VCTO, 'MM-YYYY')
    
    UNION
    SELECT 25 SEQ, '' DESCRICAO, null VALOR, TO_CHAR(A.DATA, 'MM-YYYY') ANO_MES 
    FROM TCALENDARIOS A
    GROUP BY TO_CHAR(A.DATA, 'MM-YYYY')

    UNION
    SELECT 26 SEQ, 'RESULTADO' DESCRICAO, SUM(VALOR) VALOR, ANO_MES FROM (
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE E.RECEITA = 1 AND A.DT_CANC IS NULL
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION 
        SELECT SUM(VLR_TIT) VALOR, TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
        FROM TTIT_CR
        WHERE REP_ID = 1361
        AND TP_DOC_ID IN (144)
        GROUP BY TO_CHAR(DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(A.VLR_TOTAL)*-1 VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ABI_MES
        FROM TNFS_ENTRADA A
        WHERE A.TFOR_ID = 8689
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT SUM(B.VLR_TOTAL) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') AS ANO_MES
        FROM TNFS_SAIDA A
        INNER JOIN TITENS_NFS B ON A.ID = B.NFS_ID
        INNER JOIN TTIPOS_NF E ON B.TPNF_ID = E.ID
        WHERE A.DT_CANC IS NULL
        AND A.CLI_ID = 5308
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(A.VLR_TIT)*-1) AS VALOR, TO_CHAR(A.DT_EMIS, 'MM-YYYY') ANO_MES 
        FROM TTIT_CR A
        INNER JOIN TTP_DOC B ON A.TP_DOC_ID = B.ID
        WHERE B.COD_TP_DOC IN ('DEV')
        GROUP BY TO_CHAR(A.DT_EMIS, 'MM-YYYY')
        UNION
        SELECT (SUM(CREDITO) - SUM(DEBITO))*-1 VALOR, ANO_MES FROM (
            SELECT 
            CASE WHEN TP_DOC_ID = 100 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END CREDITO,
            CASE WHEN TP_DOC_ID = 266 THEN BASE_COMIS * PERC_COMIS / 100 ELSE 0 END DEBITO,
            TO_CHAR(DT_EMIS, 'MM-YYYY') ANO_MES
            FROM TTIT_CR
            WHERE REP_ID = 1361
            AND TP_DOC_ID IN (100, 266) AND PERC_COMIS > 0) A
    GROUP BY ANO_MES
    UNION
    SELECT SUM(A.VLR_TIT)*-1 VALOR, TO_CHAR(A.DT_VCTO, 'MM-YYYY') ANO_MES
    FROM TTIT_CP A
    INNER JOIN TCTA_PLA_FIN B ON A.CTAPLFIN_ID = B.ID
    INNER JOIN TCTA_PLA_FIN C ON C.ID = B.CTAPLFIN_ID
    WHERE C.CTAPLFIN_ID NOT IN (95,102,216) AND A.TP_DOC_ID NOT in (226)
    GROUP BY TO_CHAR(A.DT_VCTO, 'MM-YYYY'))
    GROUP BY ANO_MES) A;
